(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1288:function(e,t,a){Promise.resolve().then(a.bind(a,400))},400:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var i=a(7437),r=a(8396),n=a(7156),s=a(2030),l=a(4732),c=a(5355),o=a(8472);let d=o.Z.create({timeout:1e4}),h={branding:{logo:"https://app.pixiee.io/public/logo/png/logotype.png",favicon:"https://cdn.jsdelivr.net/gh/0x1un/CDN/img/favicon.ico",title:"پیکسی",description:"به پیکسی خوش آمدید.",shape:{borderRadius:12},palette:{primary:{main:"#f44336"},secondary:{main:"#e91e63"},text:{main:"#000000"}}},legal:{privacy:"https://example.com/privacy",terms:"https://example.com/terms"},methods:[{type:"provider",text:"Sign in with Google",icon:"https://google.com/favicon",color:"red",url:"/auth/google"},{type:"provider",text:"Sign in with GitHub",icon:"https://github.com/favicon",color:"black",url:"/auth/github"},{type:"credential",options:[{identifier:"username",placeholder:"username",description:"Enter your username",regex:"^[a-zA-Z0-9_]{3,16}$",secrets:[{type:"password",placeholder:"password",description:"Enter your password",regex:"^[a-zA-Z0-9_]{6,16}$"}]},{identifier:"email",placeholder:"email",description:"Enter your email",regex:"^\\S+@\\S+\\.\\S+$",secrets:[{type:"password",placeholder:"password",description:"Enter your password"},{type:"otp",placeholder:"otp",description:"Enter the OTP"},{type:"link",placeholder:"link",description:"Enter the login link"}]},{identifier:"phone",placeholder:"phone",description:"Enter your phone number",regex:"^[0-9]{10,12}$",secrets:[{type:"otp",placeholder:"otp",description:"Enter the OTP"},{type:"password",placeholder:"password",description:"Enter your password"}]}]}],captcha_api:"/challenge",localization:{languages:["en","fa"],default:"en"}};async function p(){try{let e=await d.get("/website/config");return console.log(h),e.data}catch(e){throw e}}var u=a(487),m=()=>(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50",children:[(0,i.jsxs)("div",{className:"w-full max-w-sm p-6 bg-white rounded-lg shadow-md",children:[(0,i.jsx)("div",{className:"flex justify-center mb-6",children:(0,i.jsx)(u.default,{variant:"rectangular",width:120,height:50})}),(0,i.jsx)("div",{className:"flex justify-center mb-6",children:(0,i.jsx)(u.default,{variant:"rectangular",width:150,height:40})}),(0,i.jsx)("div",{className:"flex justify-center mb-6",children:(0,i.jsx)(u.default,{variant:"rectangular",width:150,height:20})}),(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)(u.default,{variant:"rectangular",width:"100%",height:40})}),(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)(u.default,{variant:"rectangular",width:"100%",height:40})}),(0,i.jsx)("div",{className:"flex justify-center mb-4",children:(0,i.jsx)(u.default,{variant:"text",width:40,height:40})}),(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)(u.default,{variant:"rectangular",width:"100%",height:40})})]}),(0,i.jsx)("div",{className:"flex justify-center mt-6",children:(0,i.jsx)(u.default,{variant:"text",width:200,height:20})})]}),f=a(2265),x=a(4245),g=a(7176),y=a(1665),j=a(511),b=a(7705),v=a(9381),w=a(6463);function N(e){let{data:t}=e,[a,r]=(0,f.useState)(1),[n,s]=(0,f.useState)(null),[l,c]=(0,f.useState)(null),d=(0,w.useSearchParams)().get("callback"),h=x.Ry().shape({identifier:x.Z_().test("match-any","Invalid input",function(e){return t.options.some(t=>new RegExp(t.regex).test(e))})}),p=(0,v.TA)({initialValues:{identifier:""},validationSchema:h,onSubmit:async(e,i)=>{let{setSubmitting:h}=i;try{if(1===a){let a=t.options.find(t=>new RegExp(t.regex).test(e.identifier));if(a){s(a),c(a.secrets[0].type),r(2);let t={method:a.secrets[0].method,[a.identifier]:e.identifier};await o.Z.post(a.api,t,{headers:{"Content-Type":"application/json"}}),a.secrets.forEach(e=>{p.setFieldValue(e.type,"")})}}else{let e=n.secrets.find(e=>e.type===l),t={[n.identifier]:p.values.identifier,[e.name]:p.values[e.type]},a=await o.Z.post("".concat(e.api,"?callback=").concat(d),t,{headers:{"Content-Type":"application/json"}});console.log("Login successful:",a.data)}}catch(e){console.error("API call failed:",e)}finally{h(!1)}}});(0,f.useEffect)(()=>{n&&n.secrets.length>0&&c(n.secrets[0].type)},[n]);let u=async e=>{if(c(e),n){let t=n.secrets.find(t=>t.type===e);if(t){let e={method:t.method,[n.identifier]:p.values.identifier};try{await o.Z.post(n.api,e,{headers:{"Content-Type":"application/json"}}),p.setFieldValue(t.type,"")}catch(e){console.error("API call failed while switching secret type:",e)}}}};return(0,i.jsxs)("form",{onSubmit:p.handleSubmit,children:[1===a&&(0,i.jsx)(g.Z,{dir:"ltr",name:"identifier",label:t.options.map(e=>e.identifier).join(", "),fullWidth:!0,margin:"normal",value:p.values.identifier,onChange:p.handleChange,error:p.touched.identifier&&!!p.errors.identifier,helperText:p.touched.identifier&&p.errors.identifier,className:"mb-4"}),2===a&&(0,i.jsxs)(i.Fragment,{children:[(()=>{if(!n||!l)return null;let e=n.secrets.find(e=>e.type===l);return e?(0,i.jsx)(g.Z,{name:e.type,label:e.description,placeholder:e.placeholder,type:"password"===e.type?"password":"text",fullWidth:!0,margin:"normal",className:"mb-4",value:p.values[e.type]||"",onChange:p.handleChange,error:p.touched[e.type]&&!!p.errors[e.type],helperText:p.touched[e.type]&&p.errors[e.type]}):null})(),(0,i.jsx)(j.Z,{variant:"body2",className:"mt-2 mb-4",children:"یا راه های زیر را امتحان کنید:"}),(0,i.jsx)("div",{className:"flex flex-col mb-4",children:n?n.secrets.map((e,t)=>e.type===l?null:(0,i.jsxs)(y.Z,{component:"button",variant:"body2",onClick:()=>u(e.type),className:"mr-4",children:["Try ",e.description]},t)):null})]}),(0,i.jsx)(b.Z,{type:"submit",variant:"contained",color:"primary",loading:p.isSubmitting,disabled:p.isSubmitting,fullWidth:!0,className:"mt-4",children:1===a?"ارسال":"ورود"})]})}function Z(e){let{data:t}=e;return(0,i.jsxs)("div",{className:"text-center mb-6",children:[(0,i.jsx)("img",{src:t.logo,alt:t.title,className:"w-32 object-contain mx-auto mb-4"}),(0,i.jsx)(j.Z,{variant:"h4",className:"mb-2",children:t.title}),(0,i.jsx)(j.Z,{variant:"subtitle1",children:t.description})]})}function E(e){let{providers:t}=e,a=(0,w.useSearchParams)().get("callback");return(0,i.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>(0,i.jsx)(b.Z,{fullWidth:!0,variant:"outlined",endIcon:(0,i.jsx)("img",{src:e.icon,alt:"".concat(e.text," icon"),className:"w-6 h-6 object-contain"}),className:"justify-center gap-4 normal-case py-2 text-base font-normal",href:"".concat(e.url,"?callback=").concat(a),children:e.text},t))})}function S(e){let{data:t}=e;return(0,i.jsxs)(j.Z,{variant:"body2",className:"mt-8 text-gray-600",children:[(0,i.jsx)("a",{href:t.terms,className:"hover:underline mr-4",children:"شرایط استفاده"}),"  |  ",(0,i.jsx)("a",{href:t.privacy,className:"hover:underline",children:"سیاست حفظ حریم خصوصی"})]})}function k(){let e=(0,c.a)({queryFn:p});if(e.isLoading)return(0,i.jsx)(m,{});let t=(0,l.Z)({cssVariables:!0,direction:"rtl",typography:{...e.data.branding.typography},shape:{...e.data.branding.shape},palette:{...e.data.branding.palette}});return(0,i.jsx)(r.Z,{theme:t,children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50",children:[(0,i.jsxs)(n.Z,{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-sm",children:[(0,i.jsx)(Z,{data:e.data.branding}),(0,i.jsx)(N,{data:e.data.methods.filter(e=>"credential"==e.type)[0]}),(0,i.jsx)(s.Z,{className:"my-6",children:"یا"}),(0,i.jsx)(E,{providers:e.data.methods.filter(e=>"provider"==e.type)})]}),(0,i.jsx)(S,{data:e.data.legal})]})})}}},function(e){e.O(0,[209,487,966,886,971,23,744],function(){return e(e.s=1288)}),_N_E=e.O()}]);