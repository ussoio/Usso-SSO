(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1288:function(e,t,a){Promise.resolve().then(a.bind(a,400))},400:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var i=a(7437),s=a(8396),n=a(7156),r=a(2030),l=a(4732),c=a(5355),d=a(8472);let o=d.Z.create({baseURL:"https://sso.pixiee.io/",timeout:1e4});async function h(){try{return(await o.get("https://sso.pixiee.io/website/config")).data}catch(e){throw e}}var u=a(487),m=()=>(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50",children:[(0,i.jsxs)("div",{className:"w-full max-w-sm p-6 bg-white rounded-lg shadow-md",children:[(0,i.jsx)("div",{className:"flex justify-center mb-6",children:(0,i.jsx)(u.default,{variant:"rectangular",width:120,height:50})}),(0,i.jsx)("div",{className:"flex justify-center mb-6",children:(0,i.jsx)(u.default,{variant:"rectangular",width:150,height:40})}),(0,i.jsx)("div",{className:"flex justify-center mb-6",children:(0,i.jsx)(u.default,{variant:"rectangular",width:150,height:20})}),(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)(u.default,{variant:"rectangular",width:"100%",height:40})}),(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)(u.default,{variant:"rectangular",width:"100%",height:40})}),(0,i.jsx)("div",{className:"flex justify-center mb-4",children:(0,i.jsx)(u.default,{variant:"text",width:40,height:40})}),(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)(u.default,{variant:"rectangular",width:"100%",height:40})})]}),(0,i.jsx)("div",{className:"flex justify-center mt-6",children:(0,i.jsx)(u.default,{variant:"text",width:200,height:20})})]}),f=a(2265),p=a(4245),x=a(7176),y=a(1665),j=a(511),g=a(7705),v=a(9381);function b(e){let{data:t}=e,[a,s]=(0,f.useState)(1),[n,r]=(0,f.useState)(null),[l,c]=(0,f.useState)(null),o=p.Ry().shape({identifier:p.Z_().test("match-any","Invalid input",function(e){return t.options.some(t=>new RegExp(t.regex).test(e))})}),h=(0,v.TA)({initialValues:{identifier:""},validationSchema:o,onSubmit:async(e,i)=>{let{setSubmitting:o}=i;try{if(1===a){let a=t.options.find(t=>new RegExp(t.regex).test(e.identifier));if(a){r(a),c(a.secrets[0].type),s(2);let t={method:a.secrets[0].method,[a.identifier]:e.identifier};await d.Z.post(a.api,t,{headers:{"Content-Type":"application/json"}}),a.secrets.forEach(e=>{h.setFieldValue(e.type,"")})}}else{let e=n.secrets.find(e=>e.type===l),t={[n.identifier]:h.values.identifier,[e.name]:h.values[e.type]},a=await d.Z.post(e.api,t,{headers:{"Content-Type":"application/json"}});console.log("Login successful:",a.data)}}catch(e){console.error("API call failed:",e)}finally{o(!1)}}});(0,f.useEffect)(()=>{n&&n.secrets.length>0&&c(n.secrets[0].type)},[n]);let u=async e=>{if(c(e),n){let t=n.secrets.find(t=>t.type===e);if(t){let e={method:t.method,[n.identifier]:h.values.identifier};try{await d.Z.post(n.api,e,{headers:{"Content-Type":"application/json"}}),h.setFieldValue(t.type,"")}catch(e){console.error("API call failed while switching secret type:",e)}}}};return(0,i.jsxs)("form",{onSubmit:h.handleSubmit,children:[1===a&&(0,i.jsx)(x.Z,{name:"identifier",label:"Username, Email, or Phone",fullWidth:!0,margin:"normal",value:h.values.identifier,onChange:h.handleChange,error:h.touched.identifier&&!!h.errors.identifier,helperText:h.touched.identifier&&h.errors.identifier,className:"mb-4"}),2===a&&(0,i.jsxs)(i.Fragment,{children:[(()=>{if(!n||!l)return null;let e=n.secrets.find(e=>e.type===l);return e?(0,i.jsx)(x.Z,{name:e.type,label:e.description,placeholder:e.placeholder,type:"password"===e.type?"password":"text",fullWidth:!0,margin:"normal",className:"mb-4",value:h.values[e.type]||"",onChange:h.handleChange,error:h.touched[e.type]&&!!h.errors[e.type],helperText:h.touched[e.type]&&h.errors[e.type]}):null})(),(0,i.jsx)(j.Z,{variant:"body2",className:"mt-2 mb-4",children:"Or try another way:"}),(0,i.jsx)("div",{className:"flex flex-col mb-4",children:n?n.secrets.map((e,t)=>e.type===l?null:(0,i.jsxs)(y.Z,{component:"button",variant:"body2",onClick:()=>u(e.type),className:"mr-4",children:["Try ",e.description]},t)):null})]}),(0,i.jsx)(g.Z,{type:"submit",variant:"contained",color:"primary",loading:h.isSubmitting,disabled:h.isSubmitting,fullWidth:!0,className:"mt-4",children:1===a?"Next":"Login"})]})}function w(e){let{data:t}=e;return(0,i.jsxs)("div",{className:"text-center mb-6",children:[(0,i.jsx)("img",{src:t.logo,alt:t.title,className:"w-32 object-contain mx-auto mb-4"}),(0,i.jsx)(j.Z,{variant:"h4",className:"mb-2",children:t.title}),(0,i.jsx)(j.Z,{variant:"subtitle1",children:t.description})]})}function N(e){let{providers:t}=e;return(0,i.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>(0,i.jsx)(g.Z,{fullWidth:!0,variant:"outlined",endIcon:(0,i.jsx)("img",{src:e.icon,alt:"".concat(e.text," icon"),className:"w-6 h-6 object-contain"}),className:"justify-center gap-4 normal-case py-2 text-base font-normal",href:e.url,children:e.text},t))})}function Z(e){let{data:t}=e;return(0,i.jsxs)(j.Z,{variant:"body2",className:"mt-8 text-gray-600",children:[(0,i.jsx)("a",{href:t.terms,className:"hover:underline mr-4",children:"شرایط استفاده"}),"  |  ",(0,i.jsx)("a",{href:t.privacy,className:"hover:underline",children:"سیاست حفظ حریم خصوصی"})]})}function C(){let e=(0,c.a)({queryFn:h});if(e.isLoading)return(0,i.jsx)(m,{});let t=(0,l.Z)({cssVariables:!0,direction:"rtl",typography:{...e.data.branding.typography},shape:{...e.data.branding.shape},palette:{...e.data.branding.palette}});return(0,i.jsx)(s.Z,{theme:t,children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50",children:[(0,i.jsxs)(n.Z,{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-sm",children:[(0,i.jsx)(w,{data:e.data.branding}),(0,i.jsx)(b,{data:e.data.methods.filter(e=>"credential"==e.type)[0]}),(0,i.jsx)(r.Z,{className:"my-6",children:"یا"}),(0,i.jsx)(N,{providers:e.data.methods.filter(e=>"provider"==e.type)})]}),(0,i.jsx)(Z,{data:e.data.legal})]})})}}},function(e){e.O(0,[209,487,336,886,971,23,744],function(){return e(e.s=1288)}),_N_E=e.O()}]);